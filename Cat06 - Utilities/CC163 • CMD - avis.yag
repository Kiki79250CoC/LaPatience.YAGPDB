{{deleteTrigger 0}} 
{{$args := parseArgs 1 "`-avis \"‚ÄπFeedbackContent‚Ä∫\"`" (carg "string" "FeedbackText")}}
{{$value := (dbGet 0 "avisActif").Value}}

{{if $value}}
  {{$userText := .User.Username}}
  {{if (getMember .User.ID).Nick}}
    {{$userText = print (getMember .User.ID).Nick " (" .User.String ")"}}
  {{end}}

  {{$contentPart1 := " "}}
  {{$contentPart2 := " "}}
  
  {{if lt (len ($args.Get 0)) 1024}}
    {{$contentPart1 = $args.Get 0}}
  {{else}}
    {{$list := split ($args.Get 0) " "}}
    {{range $k,$v := $list}}{{$index := (roundFloor (div (len $list) 2))}}{{if le (toInt $k) (toInt $index)}}{{$contentPart1 = joinStr " " $contentPart1 $v}}{{else}}{{$contentPart2 = joinStr " " $contentPart2 $v}}{{end}}{{end}}
  {{end}}

  {{$embed := sdict "color" 0x69ed74 "fields" (cslice (sdict "title" (print "üì´ Avis de " $userText) "name" "Contenu de l'avis :" "value" $contentPart1 "inline" false)) "timestamp" currentTime}}
  {{$fields := $embed.fields}}

  {{if (ne $contentPart2 " ")}}
    {{$fields = $fields.Append (sdict "name" " " "value" $contentPart2 "inline" false)}}
  {{end}}
  {{$embed.Set "fields" $fields}}

  {{sendMessage 693795482639794276 (complexMessage "content" (print "üì´ " (getMember 369101917659332611).User.Mention " Vous avez re√ßu un nouvel avis de " .User.Mention ".") "embed" $embed)}}

  {{sendDM (complexMessage "content" "Votre avis a √©t√© d√©livr√© sans encombres. Merci de l'int√©r√™t que vous portez pour le serveur.\n\nCopie carbone de ce qui a √©t√© re√ßu :" "embed" $embed)}}
{{else}}
  {{sendDM (complexMessage "content" "Nous sommes d√©sol√©s mais la r√©ception d'avis est d√©sactiv√©e √† l'heure actuelle. Veuillez donc r√©essayer lorsque la r√©ception des avis sera de nouveau active.\n\nA cel√†, voici une copie carbone de ce que vous avez tap√© pour ne pas avoir √† le refaire la prochaine fois :" "embed" $embed)}}
{{end}}