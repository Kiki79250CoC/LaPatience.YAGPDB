{{$args := parseArgs 1 (print "`-dbKey ‚ÄπKey‚Ä∫ ‚ÄπPage‚Ä∫`") (carg "string" "Key") (carg "int" "Page")}}
{{$page := 0}}
{{if ($args.Get 1)}}
  {{$page = mult (add ($args.Get 1) -1) 5}}
{{end}}

{{$count := 0}}
{{$x := sendMessageRetID nil (cembed "author" (sdict "name" "Chargement..."))}}
{{$total := dbCount ($args.Get 0)}}

{{$resultText := ""}}
{{if eq $total 0}}
  {{$resultText = "Aucun r√©sultat"}}
{{else if eq $total 1}}
  {{$resultText = "1 r√©sultat"}}
{{else}}
  {{$resultText = print $total " r√©sultats"}}
{{end}}

{{$count := add $page 1}}
{{$fields := cslice (sdict "name" "‚Ä¢ Infos de la recherche :" "value" (print $resultText " pour la cl√© \"" ($args.Get 0) "\"") "inline" true)}}

  {{- range (dbTopEntries ($args.Get 0) 5 $page)}}
    {{- $value := json .Value}}
    {{- $userm := .UserID}}
    {{- with (getMember .UserID)}}{{$userm = print .User.Mention " `" .User.String "`"}}{{end}}
    {{- $fields = $fields.Append (sdict "name" (print "‚Ä¢ R√©sultat de la recherche " $count " :") "value" (print "**`ID         :`** " $userm "\n**`ID valeur  :`** " .ID "\n**`Type       :`** " (printf "%T" .Value) "\n**`Caract√®res :`** " (len (reReplace `\\` (json .Value) ``)) "/100000\n**`Taille     :`** " (printf "%.2f" (fdiv (len (json .Value)) 1000)) " Ko\n**`Valeur     :`**\n```json\n" (reReplace `\\` (json $value) ``) "```") "inline" false)}}
    {{- $count = add $count 1}}
  {{- end}}

{{$embed := sdict "title" "üîé Recherche dans la base de donn√©es par entr√©e" "color" 0x00D66C "fields" $fields}}

{{if gt $count 0}}
  {{editMessage nil $x (complexMessageEdit "embed" (cembed $embed))}}
{{else}}
  {{editMessage nil $x ">>> **Erreur :**\nAucun r√©sultat correspondant √† la recherche."}}
{{end}}