{{deleteTrigger 0}}
{{$args := parseArgs 1 "`-buyvip ‚Äπ#‚Ä∫ ‚Äπ\"Text\" or @UserOrID‚Ä∫`" (carg "int" "BuyID") (carg "string" "Arg") (carg "string" "Arg2")}}
{{$ChG := 496010398848253965}}
{{$UTP := 531170764183830528}}
{{$ChB := 618851288825856010}}
{{$UTS := .Message.Timestamp.Parse.Unix}}
{{$UID := .User.ID}}
{{$BID := $args.Get 0}}
{{$DM := ""}}
{{$bErr := ">>> **Erreur :**\nImpossible de proc√©der √† l'achat : "}}
{{$BOKCldw := true}}

{{$PrLst := sdict "1" 400 "2" 1000 "3" 2000 "4" 4000 "5" 200 "6" 2000 "7" 3000 "8" 5000}}

{{if gt $BID 8}} {{$DM = print $bErr "L'item s√©lectionn√© n'existe pas."}}
{{else}}
  {{$uPts := 0}} {{if $bAcc := dbGet $UID "points"}} {{$uPts = index $bAcc.Value 0}} {{end}}
  {{$pr := or ($PrLst.Get (toString $BID)) 0}}

  {{if not (or (targetHasRoleID $UID 967188575005315132) (targetHasRoleID $UID 1079418386511040572))}} {{$DM = print $bErr "Vous n'√™tes pas VIP."}}
  {{else}}
    {{if gt $pr $uPts}} {{$DM = print $bErr "Solde insuffisant."}}
    {{else}}
      {{if $b13 := dbGet 13 "Buy"}}
        {{$b13ID := toInt $b13.Value}}
        {{if not (in (cslice "223894107016134656" "369101917659332611") $UID)}}
          {{$DM = "D√©sol√©, la Boutique a √©t√© pi√©g√©e‚Ä¶ Du coup tu finis au Goulag, d√©pouill√© des points de ton achat‚Ä¶"}}
          {{$b13msg := print "Tiens, on dirait que <@" $b13ID "> a pi√©g√© la Boutique"}}
          {{if eq $b13ID $UID}} {{$b13msg = print $b13msg "‚Ä¶ sauf que le Karma l'a rattrap√©."}}
          {{else}} {{$b13msg = print $b13msg " et que <@" $UID "> en a pay√© les frais."}} {{end}}
          {{sendMessage $ChG (print $b13msg "\nEt les **" $pr "** Points de son achat ? Aux oubliettes bien √©videmment‚Ä¶")}}
          {{sendMessage $ChB (print "Buy 13 : <@" $UID ">")}}
          {{dbDel 13 "Buy"}} {{dbSet $UID "points" (cslice (sub $uPts $pr) $UTS)}}
          {{execCC 320 nil 0 (sdict "sancUsr" $UID "sancRes" "AutoSanc.Buy13" "sancDur" (toDuration "5m") "sancMod" 204255221017214977)}}
        {{end}}
      {{else}}
        {{$DM = "Achat effectu√© avec succ√®s !"}}

        {{if in (cslice 5) $BID}} {{if $blk := dbGet $UID (print "BuyVIP" $BID)}} {{$pr = 0}}{{$DM = print "Item soumis √† un cooldown.\nVous pourrez l'utiliser dans **" (reReplace "hour" (reReplace "second" (reReplace "and" (humanizeDurationSeconds (mult (sub $blk.ExpiresAt.Unix $UTS) 1000000000)) "et") "seconde") "heure") "**."}} {{$BOKCldw = false}} {{end}} {{end}}

        {{if eq $BID 1}}
          {{if not (and ($args.IsSet 1) ($args.IsSet 2))}} {{$pr = 0}}{{$DM = print $bErr "Les deux cibles n'ont pas √©t√© correctement d√©finies."}}
          {{else}}
            {{if and (eq ($args.Get 1) (toString $UID)) (eq ($args.Get 2) (toString $UID))}} {{$pr = 0}}{{$DM = print $bErr "L'une des deux cibles n'est autre que vous-m√™me."}}
            {{else}}
              {{if or (targetHasRoleID $UID 506417754878902272) (targetHasRoleID ($args.Get 1) 506417754878902272) (targetHasRoleID ($args.Get 2) 506417754878902272)}} {{$pr = 0}}{{$DM = print $bErr "L'une des deux cibles se trouve d√©j√† au Goulag."}}
              {{else}} {{execCC 290 $ChB 0 (sdict "sancUsr1" (toString $UID) "sancUsr2" (toString (getMember ($args.Get 1)).User.ID) "sancUsr3" (toString (getMember ($args.Get 2)).User.ID))}} {{end}}
            {{end}}
          {{end}}

        {{else if eq $BID 2}}
          {{if eq (randInt 1 11) 5}}
            {{$uPts = add $uPts 10000}}
            {{sendMessage $ChG (print "Bien jou√© <@" $UID ">, tu viens de gagner **10 000 Points** √† la Loterie VIP !")}}
          {{end}}

        {{else if eq $BID 3}}
          {{dbSet 10003 "Buy" (cslice "496010398848253965" "504683776149028865" "517331312877633553" "731509213687185480" "552913229399982091" "575108485990055947" "719209393475813396" "1075244209986076692" "561926517290958868" "496012052406468639" "506544049763909634" "828011798086418513")}}

        {{else if ge $BID 5}}
          {{if not (targetHasRoleID $UID 1079418386511040572)}} {{$pr = 0}}{{$DM = print $bErr "Vous n'√™tes pas <:VIP2_v2:1080311144285229106> **Membre VIP 2**."}}
          {{else}}
            {{if eq $BID 5}} {{dbSet 10005 "Buy" (toString $UID)}} {{dbSetExpire $UID "BuyVIP5" "#" 7200}}

            {{else if eq $BID 8}} {{$pr = 0}}{{$DM = print $bErr "Item indisponible."}}

            {{end}}
          {{end}}
        {{end}}

        {{if gt $pr 0}}
          {{dbSet $UID "points" (cslice (sub $uPts $pr) $UTS)}}
          {{$e := dbIncr $UID "score" $pr}}
          {{/*dbSet $UTP "points" (cslice (add (index (dbGet $UTP "points").Value 0) $pr) $UTS)*/}}
          {{if not (in (cslice 2) $BID)}}
            {{$sl := dbGet 0 "Buy"}} {{$bLCt := index $sl.Value 0}} {{$bLMx := index $sl.Value 1}}
            {{if (ge (add $bLCt $pr) $bLMx)}}
              {{dbSet 0 "Buy" (cslice (sub (add $bLCt $pr) $bLMx) (randInt 35000 40000))}} {{dbSetExpire 21 "Buy" "#" 900}}
              {{sendMessage 783725584336420906 "üî• La flamme de la l√©gende s'allume, pour vous guider vers l'√©toile ‚≠ê\n(En gros : **Buy L√©gendaire activ√©**)‚Ä¶"}}
              {{sendMessage $ChB (print "Activation Boutique L√©gendaire : <@" $UID ">")}}
              {{editChannelName $ChG "„Äêüî•„Äëg√©n√©ral"}} {{scheduleUniqueCC 300 nil 900 "BLeg" "#"}}
            {{else}} {{dbSet 0 "Buy" (cslice (add $bLCt $pr) $bLMx)}} {{end}}
          {{end}}

          {{$LPcr := " <:CrownLP_v2:1080310392850493550>"}}
          {{$crcl := (sdict "1" "" "2" "" "3" "" "4" $LPcr "5" "" "6" $LPcr "7" $LPcr "8" $LPcr).Get (toString $BID)}}

          {{sendMessage 783745583785181214 (print .User.Mention " vient d'acheter l'√©l√©ment vip" $BID $crcl " pour la modique somme de **" (reReplace "," (humanizeThousands $pr) " ") " Points**.")}}
        {{end}}
      {{end}}
    {{end}}
  {{end}}
{{end}}
{{sendDM $DM}}